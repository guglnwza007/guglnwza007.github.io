<!doctype html>
<html lang="th" data-theme="slate">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Portfolio | Network Engineer (CCNA) – TH/EN</title>
  <meta name="description" content="สุภาพ ทางการ พอร์ตโฟลิโอสองภาษา (TH/EN) สำหรับ Network Engineer (CCNA) ประสบการณ์ ~2 ปี" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* ====== Color Themes (สุภาพ/ทางการ) ====== */
    :root{
      --bg:#f7f8fa;
      --ink:#0f172a;
      --muted:#475569;
      --card:#ffffff;
      --border:rgba(15,23,42,.10);
      --accent:#1d4ed8;
      --accent-2:#0ea5e9;
      --radius:18px; --shadow:0 10px 30px rgba(0,0,0,.06);
    }
    [data-theme="slate"]{
      --bg:#f6f7fb; --ink:#0f172a; --muted:#475569; --card:#ffffff; --border:rgba(15,23,42,.10);
      --accent:#1d4ed8; --accent-2:#0ea5e9;
    }
    [data-theme="ivory"]{
      --bg:#f9f7f3; --ink:#1f2937; --muted:#4b5563; --card:#ffffff; --border:rgba(0,0,0,.12);
      --accent:#0ea5e9; --accent-2:#2563eb;
    }
    [data-theme="mono"]{
      --bg:#f7f7f7; --ink:#111827; --muted:#6b7280; --card:#ffffff; --border:rgba(0,0,0,.12);
      --accent:#334155; --accent-2:#111827;
    }
    [data-theme="teal"]{
      --bg:#f4f9f8; --ink:#0f172a; --muted:#486269; --card:#ffffff; --border:rgba(15,23,42,.10);
      --accent:#0f766e; --accent-2:#14b8a6;
    }
    [data-theme="navy"]{
      --bg:#0b1220; --ink:#e6edf3; --muted:#a7b7c8; --card:#0f172a; --border:rgba(255,255,255,.12);
      --accent:#3b82f6; --accent-2:#60a5fa;
    }

    *{box-sizing:border-box}
    html,body{margin:0;height:100%;background:var(--bg);color:var(--ink);
      font-family:Prompt,Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;line-height:1.65}
    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}
    img{max-width:100%;display:block}
    .container{width:min(1100px,92%);margin-inline:auto}
    header.nav{position:sticky;top:0;background:rgba(255,255,255,.6);backdrop-filter:saturate(140%) blur(10px);
      border-bottom:1px solid var(--border);z-index:50}
    [data-theme="navy"] header.nav{background:rgba(11,18,32,.65)}
    .nav-inner{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
    .brand{display:flex;align-items:center;gap:10px;font-weight:600;letter-spacing:.2px}
    .brand .dot{width:10px;height:10px;border-radius:50%;background:linear-gradient(135deg, var(--accent), var(--accent-2))}
    .menu{display:flex;gap:22px}
    .menu a{font-weight:500;color:var(--muted)}
    .menu a:hover{color:var(--ink)}
    .lang-switch,.theme-switch{display:flex;gap:8px;align-items:center}
    .chip-btn{border:1px solid var(--border);padding:6px 10px;border-radius:999px;background:#fff;color:var(--ink);cursor:pointer}
    [data-theme="navy"] .chip-btn{background:#0f172a;color:#e6edf3}
    .chip-btn[aria-pressed="true"]{background:linear-gradient(135deg, var(--accent), var(--accent-2));color:#fff;border-color:transparent}
    select.theme{border:1px solid var(--border);border-radius:10px;padding:6px 10px;background:#fff;color:var(--ink)}
    [data-theme="navy"] select.theme{background:#0f172a;color:#e6edf3}

    .hero{padding:64px 0 40px}
    .hero-grid{display:grid;grid-template-columns: 1.15fr .85fr;gap:30px;align-items:center}
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow)}
    .profile{padding:28px}
    .profile h1{font-size:clamp(28px, 4vw, 44px);line-height:1.25;margin:0 0 12px}
    .subtitle{color:var(--muted);font-size:clamp(15px, 2vw, 18px);margin-bottom:18px}
    .quick{display:flex;flex-wrap:wrap;gap:10px;margin:14px 0 6px}
    .chip{border:1px solid var(--border);padding:8px 12px;border-radius:999px;background:#ffffff;font-size:14px;color:#0f1a36}
    [data-theme="navy"] .chip{background:rgba(255,255,255,.04);color:#cfe0ff;border-color:rgba(255,255,255,.12)}
    .cta{display:flex;gap:12px;margin-top:14px}
    .btn{display:inline-flex;align-items:center;gap:10px;padding:10px 14px;border-radius:12px;border:1px solid var(--border);background:#fff;color:var(--ink);font-weight:600}
    .btn.primary{background:linear-gradient(135deg, var(--accent), var(--accent-2));color:#fff;border-color:transparent}
    [data-theme="navy"] .btn{background:#0f172a;color:#e6edf3}
    .avatar{position:relative;aspect-ratio:1/1;border-radius:var(--radius);overflow:hidden}
    .avatar::before{content:"";position:absolute;inset:0;border-radius:inherit;padding:2px;background:linear-gradient(135deg, var(--accent), var(--accent-2));
      -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);-webkit-mask-composite: xor;mask-composite: exclude}
    .avatar img{width:100%;height:100%;object-fit:cover;filter:saturate(1.03) contrast(1.03)}

    section{padding:30px 0}
    .grid{display:grid;gap:18px}
    .grid.cols-3{grid-template-columns: repeat(3, 1fr)}
    .grid.cols-2{grid-template-columns: repeat(2, 1fr)}
    @media (max-width: 880px){.hero-grid{grid-template-columns:1fr}.grid.cols-3{grid-template-columns:1fr}.grid.cols-2{grid-template-columns:1fr}}

    .section-title{display:flex;align-items:center;gap:12px;font-size:22px;margin:6px 0 14px}
    .section-title .bar{width:8px;height:22px;border-radius:4px;background:linear-gradient(180deg, var(--accent), var(--accent-2))}

    .item{padding:18px;border-radius:16px;border:1px solid var(--border);background:var(--card)}
    .item h3{margin:0 0 6px;font-size:18px}
    .muted{color:var(--muted)}
    .badge{display:inline-block;padding:6px 10px;border-radius:999px;border:1px solid var(--border);font-size:12px;margin-right:6px;margin-top:6px;background:#fff}
    [data-theme="navy"] .badge{background:rgba(255,255,255,.03)}

    .bilingual .th{} .bilingual .en{font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif}
    .th[hidden], .en[hidden]{display:none !important}

    footer{border-top:1px solid var(--border);padding:26px 0 60px;color:var(--muted)}
    .toolbar{position:fixed;right:18px;bottom:18px;display:flex;flex-direction:column;gap:10px;z-index:60}
    .fab{border:none;cursor:pointer;border-radius:14px;padding:12px 14px;background:#fff;color:var(--ink);box-shadow:var(--shadow);border:1px solid var(--border)}
    [data-theme="navy"] .fab{background:#0f172a;color:#e6edf3}

    @media print{header.nav,.toolbar{display:none} body{background:#fff;color:#111} .card,.item{border:1px solid #ddd;box-shadow:none} a{color:#222;text-decoration:none} .badge,.chip{background:#fff!important}}
  </style>
</head>
<body>
  <header class="nav" role="navigation">
    <div class="container nav-inner">
      <div class="brand"><span class="dot"></span> <span>Network Engineer (CCNA)</span></div>
      <nav class="menu">
        <a href="#about">About/เกี่ยวกับ</a>
        <a href="#skills">Skills/ทักษะ</a>
        <a href="#experience">Experience/ประสบการณ์</a>
        <a href="#projects">Projects/โปรเจกต์</a>
        <a href="#certs">Certifications/ใบรับรอง</a>
        <a href="#contact">Contact/ติดต่อ</a>
      </nav>
      <div style="display:flex; gap:14px; align-items:center">
        <div class="theme-switch">
          <label for="theme" class="muted" style="font-size:14px">Theme</label>
          <select id="theme" class="theme" aria-label="Theme">
            <option value="slate">Slate & Silver</option>
            <option value="ivory">Ivory & Graphite</option>
            <option value="mono">Monochrome</option>
            <option value="teal">Teal & Sage</option>
            <option value="navy">Classic Navy</option>
          </select>
        </div>
        <div class="lang-switch" role="group" aria-label="Language switch">
          <button class="chip-btn" id="btnTH" aria-pressed="true">ไทย</button>
          <button class="chip-btn" id="btnEN" aria-pressed="false">English</button>
        </div>
      </div>
    </div>
  </header>

  <section class="hero container bilingual">
    <div class="hero-grid">
      <div class="profile card">
        <h1 id="hero-name-th" class="th">ชื่อ-นามสกุล <span style="font-weight:500;color:var(--muted)">| วิศวกรเครือข่าย</span></h1>
        <h1 id="hero-name-en" class="en" hidden>Full Name <span style="font-weight:500;color:var(--muted)">| Network Engineer</span></h1>

        <div id="hero-summary-th" class="subtitle th">โปรดแก้ไข summary ภาษาไทยใน site.json</div>
        <div id="hero-summary-en" class="subtitle en" hidden>Please edit English summary in site.json</div>

        <div id="quick-tags" class="quick"></div>

        <div class="cta">
          <a class="btn primary" href="#contact">ติดต่อ / Contact</a>
          <a class="btn" href="#" onclick="window.print();return false;">พิมพ์เป็น PDF / Save as PDF</a>
          <a class="btn" href="admin.html">Admin (แก้ไข)</a>
        </div>
      </div>
      <div class="avatar">
        <img id="avatar" src="https://images.unsplash.com/photo-1600486913747-55e0876a2b65?q=80&w=1200&auto=format&fit=crop" alt="Profile" />
      </div>
    </div>
  </section>

  <section id="about" class="container bilingual">
    <div class="section-title"><span class="bar"></span><h2>About / เกี่ยวกับฉัน</h2></div>
    <div id="about-th" class="item th">โหลดจาก site.json</div>
    <div id="about-en" class="item en" hidden>Loaded from site.json</div>
  </section>

  <section id="skills" class="container bilingual">
    <div class="section-title"><span class="bar"></span><h2>Skills / ทักษะ</h2></div>
    <div class="grid cols-3">
      <div class="item">
        <h3>Routing & Switching</h3>
        <div id="skills-routing" class="muted"></div>
        <div id="badges-routing"></div>
      </div>
      <div class="item">
        <h3>Network Security</h3>
        <div id="skills-security" class="muted"></div>
        <div id="badges-security"></div>
      </div>
      <div class="item">
        <h3>Wireless & Monitoring</h3>
        <div id="skills-wireless" class="muted"></div>
        <div id="badges-wireless"></div>
      </div>
    </div>
  </section>

  <section id="experience" class="container bilingual">
    <div class="section-title"><span class="bar"></span><h2>Experience / ประสบการณ์</h2></div>
    <div id="exp-container" class="grid"></div>
  </section>

  <section id="projects" class="container bilingual">
    <div class="section-title"><span class="bar"></span><h2>Projects / โปรเจกต์</h2></div>
    <div id="proj-container" class="grid cols-2"></div>
  </section>

  <section id="certs" class="container bilingual">
    <div class="section-title"><span class="bar"></span><h2>Certifications / ใบรับรอง</h2></div>
    <div id="certs-container" class="grid cols-3"></div>
  </section>

  <section class="container bilingual">
    <div class="section-title"><span class="bar"></span><h2>Education & Languages / การศึกษา & ภาษา</h2></div>
    <div class="grid cols-2">
      <div class="item">
        <h3 class="th">การศึกษา</h3><h3 class="en" hidden>Education</h3>
        <ul id="edu-list"></ul>
      </div>
      <div class="item">
        <h3 class="th">ภาษา</h3><h3 class="en" hidden>Languages</h3>
        <ul id="lang-list"></ul>
      </div>
    </div>
  </section>

  <section id="contact" class="container bilingual">
    <div class="section-title"><span class="bar"></span><h2>Contact / ติดต่อ</h2></div>
    <div class="grid cols-2">
      <div class="item">
        <h3 class="th">ข้อมูลติดต่อ</h3><h3 class="en" hidden>Contact Details</h3>
        <ul class="muted" style="padding-left:18px" id="contact-list"></ul>
      </div>
      <div class="item">
        <h3>Attachments / เอกสารแนบ</h3>
        <p class="muted th">แนบเรซูเม่ (PDF), ไดอะแกรมเครือข่าย, และลิงก์ผลงาน</p>
        <p class="muted en" hidden>Attach resume (PDF), network diagrams, and portfolio links.</p>
        <div>
          <a class="btn" href="#" onclick="window.print();return false;">ดาวน์โหลด/พิมพ์เป็น PDF</a>
        </div>
      </div>
    </div>
  </section>

  <footer>
    <div class="container">
      © <span id="y"></span> • Network Engineer (CCNA) • Formal Bilingual Portfolio
    </div>
  </footer>

  <div class="toolbar">
    <button class="fab" title="เลื่อนขึ้น" onclick="window.scrollTo({top:0,behavior:'smooth'})">↑ เลื่อนขึ้น</button>
    <button class="fab" title="TH" id="fabTH">TH</button>
    <button class="fab" title="EN" id="fabEN">EN</button>
    <button class="fab" title="PDF" onclick="window.print()">⎙ PDF</button>
  </div>

  <!-- Default data fallback -->
  <script id="default-data" type="application/json">
  {
    "theme": "slate",
    "profile": {
      "full_name": "ชื่อ-นามสกุล / Full Name",
      "role_th": "วิศวกรเครือข่าย",
      "role_en": "Network Engineer",
      "summary_th": "วิศวกรเครือข่ายผู้ถือ CCNA เน้นความเสถียร ความปลอดภัย และการออกแบบที่ดูแลง่าย ประสบการณ์ทำงาน ~2 ปี",
      "summary_en": "CCNA-certified network engineer focused on stability, security, and maintainable designs with ~2 years of experience.",
      "quick_tags": ["OSPF", "VLAN", "Firewall", "VPN", "WLC", "Monitoring"],
      "avatar_url": "https://images.unsplash.com/photo-1600486913747-55e0876a2b65?q=80&w=1200&auto=format&fit=crop"
    },
    "about_th": "มุ่งมั่นในการออกแบบ ติดตั้ง และดูแลระบบเครือข่าย LAN/WAN ให้พร้อมใช้งานสูงและปลอดภัย ประสานงานกับทีม System/Dev/Ops และคู่ค้าอย่างมืออาชีพ",
    "about_en": "Committed to designing, deploying, and operating secure, highly available LAN/WAN infrastructures; collaborate with System/Dev/Ops teams and vendors.",
    "skills": {
      "routing": ["OSPF", "Static", "HSRP", "STP/RSTP", "VLAN", "Inter-VLAN", "EtherChannel"],
      "security": ["ACL", "NAT", "VPN (IPsec/SSL)", "Zone-Based Firewall", "802.1X", "Port Security"],
      "wireless": ["WLC", "Site Survey/Heatmap", "QoS", "SNMP", "Syslog", "NetFlow", "Alerting"],
      "badges_routing": ["Cisco Catalyst","Cisco ISR","MikroTik"],
      "badges_security": ["Cisco ASA/FTD","pfSense","Suricata"],
      "badges_wireless": ["Cisco WLC","UniFi","PRTG/Zabbix"]
    },
    "experience": [
      {
        "company_th":"บริษัท ABC จำกัด","company_en":"ABC Co., Ltd.",
        "role_th":"วิศวกรเครือข่าย","role_en":"Network Engineer",
        "from":"ม.ค. 2024","to":"ปัจจุบัน","from_en":"Jan 2024","to_en":"Present",
        "points_th":["ออกแบบ/ปรับปรุงโครงข่ายสาขา (ทดสอบ SD-WAN) ลดเหตุขัดข้อง ~30%",
                      "ดูแล Switch/Router/Firewall และ VPN สำหรับพนักงาน",
                      "จัดทำ Runbook/Template ลดเวลาติดตั้งสาขาใหม่จาก 2 วันเหลือ ~6 ชม."],
        "points_en":["Designed/optimized branch networks (SD‑WAN pilot), reducing incidents by ~30%.",
                      "Operated switches/routers/firewalls and VPN solutions for staff.",
                      "Authored runbooks/templates; cut new‑site deployment time from 2 days to ~6 hours."]
      },
      {
        "company_th":"บริษัท XYZ โซลูชัน","company_en":"XYZ Solutions",
        "role_th":"NOC/Support","role_en":"NOC/Support",
        "from":"ต.ค. 2023","to":"ธ.ค. 2023","from_en":"Oct 2023","to_en":"Dec 2023",
        "points_th":["มอนิเตอร์อุปกรณ์ 200+ ตัวและแก้ไขเหตุขัดข้องร่วมกับทีมภาคสนาม",
                      "วิเคราะห์ปัญหา L1‑L2 (link/duplex/DHCP/DNS) และ Escalate กรณี L3"],
        "points_en":["Monitored 200+ devices; coordinated incident remediation with field teams.",
                      "Troubleshot L1–L2 (link/duplex/DHCP/DNS) and escalated L3 cases."]
      }
    ],
    "projects": [
      {
        "name":"Campus Network Revamp",
        "desc_th":"ออกแบบ Core‑Distribution‑Access พร้อม VLAN Segmentation และ 802.1X",
        "desc_en":"Redesigned core‑distribution‑access with VLAN segmentation and 802.1X.",
        "bullets_th":["เอกสาร HLD/LLD, Diagram, IP Plan, Template Config"],
        "bullets_en":["Delivered HLD/LLD, diagrams, IP plan, configuration templates"]
      },
      {
        "name":"Branch Wi‑Fi Modernization",
        "desc_th":"ทำ Site Survey/Heatmap ปรับช่อง/กำลังส่ง และตั้งค่า WLC",
        "desc_en":"Conducted site survey/heatmaps, tuned channels/Tx power, and configured WLC.",
        "bullets_th":["Latency ลดลง ~20% และ Ticket ด้าน Wi‑Fi ลดลงชัดเจน"],
        "bullets_en":["Reduced latency by ~20% and significantly lowered Wi‑Fi tickets"]
      }
    ],
    "certifications":[
      {"name":"CCNA","issuer":"Cisco","id":"XXXXXXXX"},
      {"name":"MTCNA (optional)","issuer":"MikroTik","id":"XXXXXXXX"}
    ],
    "education":[
      {"degree_th":"วท.บ. วิศวกรรมคอมพิวเตอร์","degree_en":"B.Eng. in Computer Engineering","school":"มหาวิทยาลัยตัวอย่าง / Example University","year":"20XX"}
    ],
    "languages":[
      {"th":"ไทย (เจ้าของภาษา)","en":"Thai (native)"},
      {"th":"อังกฤษ (สื่อสารด้านเทคนิคได้ดี – TOEIC 7xx)","en":"English (strong technical communication – TOEIC 7xx)"}
    ],
    "contacts": {
      "email":"your.name@example.com",
      "phone":"+66-8x-xxx-xxxx",
      "linkedin":"https://linkedin.com/in/yourname",
      "github":"https://github.com/yourname",
      "location_th":"กรุงเทพมหานคร",
      "location_en":"Bangkok, Thailand"
    }
  }
  </script>

  <script>
    const $ = (sel, root=document)=> root.querySelector(sel);
    const $$ = (sel, root=document)=> Array.from(root.querySelectorAll(sel));
    const y = $('#y'); y.textContent = new Date().getFullYear();
    const btnTH = $('#btnTH'), btnEN = $('#btnEN'), fabTH = $('#fabTH'), fabEN = $('#fabEN');
    const themeSel = $('#theme');

    // Smooth scroll
    $$('a[href^="#"]').forEach(a=>{
      a.addEventListener('click', e=>{
        const id=a.getAttribute('href'); if(id==="#") return;
        const el=document.querySelector(id); if(!el) return;
        e.preventDefault(); el.scrollIntoView({behavior:'smooth', block:'start'});
      });
    });

    // Language switch
    function showTH(){
      $$('.th').forEach(el=>el.hidden=false);
      $$('.en').forEach(el=>el.hidden=true);
      btnTH?.setAttribute('aria-pressed','true');
      btnEN?.setAttribute('aria-pressed','false');
      localStorage.setItem('lang','th');
    }
    function showEN(){
      $$('.th').forEach(el=>el.hidden=true);
      $$('.en').forEach(el=>el.hidden=false);
      btnTH?.setAttribute('aria-pressed','false');
      btnEN?.setAttribute('aria-pressed','true');
      localStorage.setItem('lang','en');
    }
    btnTH?.addEventListener('click', showTH); btnEN?.addEventListener('click', showEN);
    fabTH?.addEventListener('click', showTH); fabEN?.addEventListener('click', showEN);
    // restore language
    (localStorage.getItem('lang') === 'en') ? showEN() : showTH();

    // Theme switch
    function applyTheme(val){ document.documentElement.setAttribute('data-theme', val); localStorage.setItem('theme', val); themeSel.value=val; }
    themeSel.addEventListener('change', (e)=> applyTheme(e.target.value));
    applyTheme(localStorage.getItem('theme') || 'slate');

    // Render helpers
    function setText(idTH, idEN, th, en){
      if ($(idTH)) $(idTH).innerText = th || '';
      if ($(idEN)) $(idEN).innerText = en || '';
    }
    function el(tag, cls, text){ const n=document.createElement(tag); if(cls) n.className=cls; if(text!=null) n.textContent=text; return n; }

    function render(data){
      // hero
      $('#hero-name-th').innerHTML = (data.profile.full_name||'ชื่อ-นามสกุล') + ' <span style="font-weight:500;color:var(--muted)">| '+(data.profile.role_th||'วิศวกรเครือข่าย')+'</span>';
      $('#hero-name-en').innerHTML = (data.profile.full_name||'Full Name') + ' <span style="font-weight:500;color:var(--muted)">| '+(data.profile.role_en||'Network Engineer')+'</span>';
      $('#hero-summary-th').textContent = data.profile.summary_th || '';
      $('#hero-summary-en').textContent = data.profile.summary_en || '';
      $('#avatar').src = data.profile.avatar_url || $('#avatar').src;
      // quick tags
      const qt = $('#quick-tags'); qt.innerHTML=''; (data.profile.quick_tags||[]).forEach(t=> qt.appendChild(el('span','chip',t)));
      // about
      $('#about-th').textContent = data.about_th || '';
      $('#about-en').textContent = data.about_en || '';
      // skills lines
      const s = data.skills || {};
      $('#skills-routing').textContent = (s.routing||[]).join(', ');
      $('#skills-security').textContent = (s.security||[]).join(', ');
      $('#skills-wireless').textContent = (s.wireless||[]).join(', ');
      // badges
      function fillBadges(id, arr){ const root=$(id); root.innerHTML=''; (arr||[]).forEach(b=> root.appendChild(el('span','badge',b))); }
      fillBadges('#badges-routing', s.badges_routing);
      fillBadges('#badges-security', s.badges_security);
      fillBadges('#badges-wireless', s.badges_wireless);
      // experience
      const expC = $('#exp-container'); expC.innerHTML='';
      (data.experience||[]).forEach(x=>{
        const card = el('div','item');
        const hth = el('h3','th', `${x.role_th||''} – ${x.company_th||''} `); const spanTH = el('span','muted', ` (${x.from||''} – ${x.to||''})`); hth.appendChild(spanTH);
        const hen = el('h3','en', `${x.role_en||''} – ${x.company_en||''} `); const spanEN = el('span','muted', ` (${x.from_en||''} – ${x.to_en||''})`); hen.appendChild(spanEN); hen.hidden = true;
        const ulTH = el('ul','th'); (x.points_th||[]).forEach(p=> ulTH.appendChild(el('li','',p)));
        const ulEN = el('ul','en'); (x.points_en||[]).forEach(p=> ulEN.appendChild(el('li','',p))); ulEN.hidden = true;
        card.appendChild(hth); card.appendChild(hen); card.appendChild(ulTH); card.appendChild(ulEN);
        expC.appendChild(card);
      });
      // projects
      const projC = $('#proj-container'); projC.innerHTML='';
      (data.projects||[]).forEach(p=>{
        const card = el('div','item');
        const h = el('h3','', p.name||''); card.appendChild(h);
        const dth = el('div','muted th', p.desc_th||''); const den = el('div','muted en', p.desc_en||''); den.hidden = true;
        card.appendChild(dth); card.appendChild(den);
        if ((p.bullets_th && p.bullets_th.length) || (p.bullets_en && p.bullets_en.length)){
          const ulTH = el('ul','th'); (p.bullets_th||[]).forEach(b=> ulTH.appendChild(el('li','',b)));
          const ulEN = el('ul','en'); (p.bullets_en||[]).forEach(b=> ulEN.appendChild(el('li','',b))); ulEN.hidden = true;
          card.appendChild(ulTH); card.appendChild(ulEN);
        }
        projC.appendChild(card);
      });
      // certifications
      const certC = $('#certs-container'); certC.innerHTML='';
      (data.certifications||[]).forEach(c=>{
        const card = el('div','item');
        const h = el('h3','', c.name||''); card.appendChild(h);
        const issuer = el('div','muted', c.issuer ? `Issuer: ${c.issuer}` : ''); card.appendChild(issuer);
        if (c.id) card.appendChild(el('div','badge', `ID: ${c.id}`));
        certC.appendChild(card);
      });
      // edu & languages
      const edu = $('#edu-list'); edu.innerHTML='';
      (data.education||[]).forEach(e=>{
        const liTH = el('li','th', `${e.degree_th||''} – ${e.school||''} ${e.year? '('+e.year+')':''}`);
        const liEN = el('li','en', `${e.degree_en||''} – ${e.school||''} ${e.year? '('+e.year+')':''}`); liEN.hidden = true;
        edu.appendChild(liTH); edu.appendChild(liEN);
      });
      const lang = $('#lang-list'); lang.innerHTML='';
      (data.languages||[]).forEach(l=>{
        const liTH = el('li','th', l.th||''); const liEN = el('li','en', l.en||''); liEN.hidden = true;
        lang.appendChild(liTH); lang.appendChild(liEN);
      });
      // contact
      const cl = $('#contact-list'); cl.innerHTML='';
      const c = data.contacts||{};
      function addContact(labelTH, labelEN, value, href){
        if(!value) return;
        const liTH = el('li','th', `${labelTH}: `); const a = el('a','', value); if(href) a.href = href; liTH.appendChild(a);
        const liEN = el('li','en', `${labelEN}: `); const a2 = el('a','', value); if(href) a2.href = href; liEN.appendChild(a2); liEN.hidden = true;
        cl.appendChild(liTH); cl.appendChild(liEN);
      }
      addContact('อีเมล','Email', c.email, `mailto:${c.email}`);
      addContact('โทร','Phone', c.phone, `tel:${c.phone}`);
      addContact('LinkedIn','LinkedIn', c.linkedin, c.linkedin);
      addContact('GitHub','GitHub', c.github, c.github);
      // location line
      if (c.location_th || c.location_en){
        const liTH = el('li','th', `ที่อยู่ปัจจุบัน: ${c.location_th||''}`);
        const liEN = el('li','en', `Current Location: ${c.location_en||''}`); liEN.hidden = true;
        cl.appendChild(liTH); cl.appendChild(liEN);
      }
      // theme from data (optional)
      if (data.theme) applyTheme(data.theme);
    }

    async function loadData(){
      const fallback = JSON.parse(document.getElementById('default-data').textContent);
      try{
        const res = await fetch('site.json', {cache:'no-store'});
        if(!res.ok) throw new Error('fetch site.json failed');
        const data = await res.json();
        render(Object.assign({}, fallback, data));
      }catch(e){
        render(fallback);
      }
    }
    loadData();
  </script>
</body>
</html>
