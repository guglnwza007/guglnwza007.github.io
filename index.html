<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ชาคร หวังปอ | Network Engineer (CCNA)</title>
  <meta name="description" content="ชาคร หวังปอ — Network Engineer (CCNA) โฟกัสความเสถียร ความปลอดภัย และการออกแบบเครือข่ายที่ดูแลต่อได้ พร้อมประสบการณ์ ~2 ปี" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=IBM+Plex+Mono:wght@400;600&display=swap" rel="stylesheet">

  <!-- Canonical & Verification (ปรับเองให้ตรง repo) -->
  <link rel="canonical" href="https://<username>.github.io/<repo>/" />
  <meta name="google-site-verification" content="<paste-from-search-console>" />

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="profile">
  <meta property="og:title" content="ชาคร หวังปอ | Network Engineer (CCNA)">
  <meta property="og:description" content="โฟกัสเสถียรภาพ-ความปลอดภัย ออกแบบเครือข่ายที่ดูแลต่อได้">
  <meta property="og:image" content="https://<username>.github.io/<repo>/assets/images/profile.jpg">
  <meta property="og:url" content="https://<username>.github.io/<repo>/">
  <meta property="og:locale" content="th_TH">
  <meta name="twitter:card" content="summary_large_image">

  <style>
    /* =====================
       THEME & TOKENS
       ===================== */
    :root{
      --bg: #0b0d12;
      --surface: #0f1421;
      --panel: #11182a;
      --card: #141c2f;
      --text:#e8eef8;
      --muted:#a9b6ca;
      --primary:#62a8ff;   /* cornflower */
      --primary-2:#7dd3fc; /* sky */
      --accent:#22d3ee;    /* cyan */
      --success:#34d399;
      --danger:#ef4444;
      --ring: 0 0 0 8px rgba(98,168,255,.18);
      --shadow: 0 20px 50px rgba(0,0,0,.35);
      --radius-lg: 22px;
      --radius-md: 14px;
      --radius-sm: 10px;
      --grid-max: 1180px;
    }
    .light{
      --bg: #f6f8fc;
      --surface:#ffffff;
      --panel:#ffffff;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#596579;
      --primary:#2563eb;   /* blue-600 */
      --primary-2:#06b6d4; /* cyan-500 */
      --accent:#0ea5e9;
      --ring: 0 0 0 8px rgba(37,99,235,.14);
      --shadow: 0 14px 40px rgba(2,6,23,.08);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        radial-gradient(800px 400px at 10% -10%, rgba(98,168,255,.14), transparent 60%),
        radial-gradient(800px 400px at 90% -10%, rgba(125,211,252,.12), transparent 60%),
        linear-gradient(180deg, var(--bg), var(--surface) 40%, var(--bg));
      line-height:1.65;
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }
    img{max-width:100%; display:block}
    a{color:var(--primary); text-decoration:none}
    a:hover{filter:brightness(1.1)}
    .container{width:min(var(--grid-max), 92vw); margin-inline:auto}
    .visually-hidden{position:absolute!important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}

    /* =====================
       TOP NAV
       ===================== */
    .topbar{position:sticky; top:0; z-index:50; backdrop-filter:saturate(140%) blur(10px); background:color-mix(in oklab, var(--surface) 86%, transparent); border-bottom:1px solid color-mix(in oklab, var(--muted) 24%, transparent)}
    .topbar-inner{display:flex; align-items:center; justify-content:space-between; gap:16px; padding:14px 0}
    .brand{display:flex; align-items:center; gap:12px; font-weight:800; letter-spacing:.3px}
    .logo-dot{width:12px; height:12px; border-radius:999px; background:linear-gradient(135deg,var(--primary), var(--primary-2)); box-shadow:var(--ring)}
    nav ul{display:flex; gap:18px; list-style:none; padding:0; margin:0}
    nav a{color:var(--text); opacity:.85}
    nav a:hover{opacity:1}
    .controls{display:flex; gap:10px}
    .btn{display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:12px; background:var(--panel); color:var(--text); border:1px solid color-mix(in oklab, var(--muted) 22%, transparent); box-shadow: var(--shadow); cursor:pointer}
    .btn:hover{transform:translateY(-1px)}
    .btn.primary{background:linear-gradient(135deg, var(--primary), var(--primary-2)); color:#fff; border:none}
    .btn.ghost{background:transparent}

    /* =====================
       HERO
       ===================== */
    .hero{display:grid; grid-template-columns: 1.15fr .85fr; gap:28px; padding:48px 0 20px; position:relative}
    .badge{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; background:color-mix(in oklab, var(--primary) 12%, transparent); color:var(--primary); border:1px dashed color-mix(in oklab, var(--primary) 40%, transparent); font-weight:700}
    .title{font-size:clamp(30px, 3.2vw, 46px); line-height:1.15; margin:12px 0 8px; letter-spacing:.2px}
    .subtitle{font-size:clamp(16px,1.4vw,19px); color:var(--muted); margin:0 0 18px}
    .chips{display:flex; flex-wrap:wrap; gap:10px}
    .chip{padding:8px 12px; background:var(--card); border:1px solid color-mix(in oklab, var(--muted) 24%, transparent); border-radius:999px; font-weight:600; color:var(--muted)}
    .avatar-card{position:relative; border-radius:28px; border:1px solid color-mix(in oklab, var(--muted) 24%, transparent); background:radial-gradient(1200px 600px at 20% 0%, color-mix(in oklab, var(--primary) 14%, transparent), transparent 50%), var(--card); box-shadow: var(--shadow); padding:14px}
    .avatar-wrap{aspect-ratio:1/1; border-radius:22px; border:2px dashed color-mix(in oklab, var(--primary) 45%, transparent); display:grid; place-items:center; overflow:hidden; background:color-mix(in oklab, var(--surface) 60%, transparent)}
    .avatar-wrap img{width:100%; height:100%; object-fit:cover}

    /* =====================
       SECTIONS
       ===================== */
    section{padding:28px 0}
    .section-title{display:flex; align-items:center; justify-content:space-between; margin:8px 0 18px}
    .section-title h2{margin:0; font-size:22px}
    .grid{display:grid; gap:16px}
    .grid.cols-2{grid-template-columns:1fr 1fr}
    .grid.cols-3{grid-template-columns:repeat(3, 1fr)}
    .card{background:var(--card); border:1px solid color-mix(in oklab, var(--muted) 24%, transparent); border-radius:18px; padding:16px; box-shadow: var(--shadow)}
    .card h3{margin:0 0 6px; font-size:18px}
    .card p{margin:6px 0 0; color:var(--muted)}
    .meta{display:flex; flex-wrap:wrap; gap:8px; margin-top:10px; font-size:12px; color:var(--muted)}

    /* =====================
       FOOTER
       ===================== */
    footer{padding:28px 0 56px; color:var(--muted)}

    /* =====================
       ADMIN PANEL (Modal)
       ===================== */
    dialog#adminModal{width:min(980px, 92vw); border:none; border-radius:var(--radius-lg); padding:0; background:var(--surface); color:var(--text); box-shadow: var(--shadow)}
    dialog::backdrop{backdrop-filter: blur(4px); background:rgba(0,0,0,.4)}

    .admin-header{display:flex; align-items:center; justify-content:space-between; padding:16px 18px; border-bottom:1px solid color-mix(in oklab, var(--muted) 22%, transparent)}
    .admin-title{display:flex; align-items:center; gap:10px; font-weight:800}
    .admin-body{display:grid; grid-template-columns: 220px 1fr; min-height:500px}
    .admin-nav{border-right:1px solid color-mix(in oklab, var(--muted) 22%, transparent); padding:14px}
    .admin-nav button{display:block; width:100%; text-align:left; padding:10px 12px; margin-bottom:8px; border-radius:10px; border:1px solid color-mix(in oklab, var(--muted) 18%, transparent); background:var(--panel); color:var(--text)}
    .admin-nav button.active{outline:2px solid color-mix(in oklab, var(--primary) 55%, transparent)}
    .admin-content{padding:16px; display:grid; gap:14px}
    .field{display:grid; gap:6px}
    .field label{font-size:12px; color:var(--muted)}
    .field input,.field textarea{padding:10px 12px; border-radius:12px; border:1px solid color-mix(in oklab, var(--muted) 24%, transparent); background:var(--panel); color:var(--text)}
    .field textarea{min-height:96px}
    .row{display:grid; gap:10px; grid-template-columns:1fr 1fr}
    .table{width:100%; border-collapse:separate; border-spacing:0; font-size:14px}
    .table th,.table td{padding:10px 12px; border-bottom:1px solid color-mix(in oklab, var(--muted) 18%, transparent)}
    .toolbar{display:flex; gap:10px; align-items:center}
    .kbd{font-family:"IBM Plex Mono", ui-monospace, SFMono-Regular, Menlo, monospace; font-size:12px; padding:.1rem .4rem; border-radius:6px; background:color-mix(in oklab, var(--muted) 15%, transparent); border:1px solid color-mix(in oklab, var(--muted) 25%, transparent)}

    /* =====================
       RESPONSIVE
       ===================== */
    @media (max-width: 960px){
      .hero{grid-template-columns:1fr}
      .grid.cols-2{grid-template-columns:1fr}
      .grid.cols-3{grid-template-columns:1fr}
      .admin-body{grid-template-columns:1fr}
      .row{grid-template-columns:1fr}
    }

    /* =====================
       PRINT (PDF)
       ===================== */
    @media print{
      .topbar, .controls, #adminBtn, .admin-only{display:none!important}
      body{background:#fff; color:#111}
      .card{box-shadow:none; border:1px solid #ddd}
    }

    /* Accessibility helpers */
    @media (prefers-reduced-motion: reduce){
      *{scroll-behavior:auto!important}
    }
  </style>
</head>
<body class="light" data-i18n-scope>
  <a href="#content" class="visually-hidden">ข้ามไปยังเนื้อหา</a>

  <header class="topbar" role="banner">
    <div class="container topbar-inner">
      <div class="brand" aria-label="Site brand">
        <span class="logo-dot" aria-hidden="true"></span>
        <span>Network Engineer</span>
      </div>
      <nav aria-label="Main navigation">
        <ul>
          <li><a href="#about">เกี่ยวกับ</a></li>
          <li><a href="#skills">ทักษะ</a></li>
          <li><a href="#experience">ประสบการณ์</a></li>
          <li><a href="#projects">โปรเจกต์</a></li>
          <li><a href="#certs">Certs</a></li>
          <li><a href="#contact">ติดต่อ</a></li>
        </ul>
      </nav>
      <div class="controls" role="group" aria-label="Quick actions">
        <button class="btn" id="themeToggle" title="Theme">🌓 <span class="hide-md">ธีม</span></button>
        <button class="btn" id="langToggle" title="Language">🌐 <span class="hide-md" id="langLabel">EN</span></button>
        <button class="btn primary admin-only" id="adminBtn">⚙️ Admin</button>
        <a class="btn" id="printBtn" href="#">🖨️ PDF</a>
      </div>
    </div>
  </header>

  <main id="content" class="container" tabindex="-1">
    <!-- HERO -->
    <section class="hero" id="home">
      <div>
        <span class="badge" id="badge">CCNA • OSPF • VLAN • VPN • WLC • Firewall</span>
        <h1 class="title"><span id="name">ชาคร หวังปอ</span> <span class="muted">|</span> <span id="role">Network Engineer</span></h1>
        <p class="subtitle" id="summary">CCNA‑certified network engineer focused on stability, security, and maintainable designs with ~2 years of experience.</p>
        <div class="chips" id="tags"></div>
        <div class="toolbar" style="margin-top:18px">
          <a class="btn primary" href="#projects">ดูผลงาน</a>
          <a class="btn ghost" href="#contact">ติดต่อ</a>
          <span class="kbd" title="กด P เพื่อพิมพ์">P</span>
        </div>
      </div>
      <div class="avatar-card" aria-label="Profile image">
        <div class="avatar-wrap">
          <img id="avatar" src="https://scontent.fbkk7-2.fna.fbcdn.net/v/t39.30808-6/475861265_3742993102659518_288014145638799882_n.jpg?_nc_cat=106&ccb=1-7&_nc_sid=6ee11a&_nc_eui2=AeEUdHGLU2ymtIg8lUzeaPYeRG4mSA8e_cxEbiZIDx79zNG_4I3XqmrFUwSpefrBuKTlYnwPTDVuk1u-Uizh7dyn&_nc_ohc=6KJpjbvQDPsQ7kNvwEmzUfF&_nc_oc=AdlXlXkFtOy6eSGv4dLb0sa6olcXNGjMM7IkBibW52Jf3sDHeTPe_vosgzAuF8zhDas&_nc_zt=23&_nc_ht=scontent.fbkk7-2.fna&_nc_gid=giS58Mya2oJHgIhcy1DvAg&oh=00_Afd3kgTlYY3whQW_dfF_2ZEnFUrU0-9P7x6yRvN1JKGQNA&oe=68F55CD0" alt="รูปโปรไฟล์ของ ชาคร หวังปอ – Network Engineer" loading="lazy" />
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="about">
      <div class="section-title">
        <h2>About / เกี่ยวกับ</h2>
      </div>
      <div class="card" id="aboutText">Designing secure, resilient networks with a strong focus on documentation and monitoring.</div>
    </section>

    <!-- SKILLS -->
    <section id="skills">
      <div class="section-title">
        <h2>Skills / ทักษะ</h2>
      </div>
      <div class="grid cols-3" id="skillsGrid"></div>
    </section>

    <!-- EXPERIENCE -->
    <section id="experience">
      <div class="section-title">
        <h2>Experience / ประสบการณ์</h2>
      </div>
      <div class="grid" id="expGrid"></div>
    </section>

    <!-- PROJECTS -->
    <section id="projects">
      <div class="section-title">
        <h2>Projects / โปรเจกต์</h2>
      </div>
      <div class="grid cols-2" id="projGrid"></div>
    </section>

    <!-- CERTIFICATIONS -->
    <section id="certs">
      <div class="section-title">
        <h2>Certifications</h2>
      </div>
      <div class="grid" id="certGrid"></div>
    </section>

    <!-- CONTACT -->
    <section id="contact">
      <div class="section-title">
        <h2>Contact / ติดต่อ</h2>
      </div>
      <div class="grid cols-2">
        <div class="card">
          <h3 id="contactName">MoonLPO</h3>
          <p id="contactRole">Network Engineer</p>
          <div class="meta" id="contactMeta"></div>
        </div>
        <div class="card">
          <form id="contactForm" onsubmit="event.preventDefault(); alert('ขอบคุณที่ติดต่อครับ!'); this.reset();">
            <div style="display:grid; gap:10px; grid-template-columns:1fr 1fr">
              <input required placeholder="ชื่อ / Name" aria-label="Name" style="padding:10px;border-radius:10px;border:1px solid color-mix(in oklab, var(--muted) 24%, transparent);background:var(--panel);color:var(--text)">
              <input type="email" required placeholder="อีเมล / Email" aria-label="Email" style="padding:10px;border-radius:10px;border:1px solid color-mix(in oklab, var(--muted) 24%, transparent);background:var(--panel);color:var(--text)">
            </div>
            <textarea required placeholder="ข้อความ / Message" aria-label="Message" rows="5" style="margin-top:10px;padding:10px;border-radius:10px;border:1px solid color-mix(in oklab, var(--muted) 24%, transparent);background:var(--panel);color:var(--text)"></textarea>
            <button class="btn primary" style="margin-top:10px">ส่งข้อความ</button>
          </form>
        </div>
      </div>
    </section>
  </main>

  <footer class="container">
    <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:10px">
      <small>© <span id="year"></span> <span id="footName">MoonLPO</span>. All rights reserved.</small>
      <div class="meta"><a href="#home">Back to top ↑</a></div>
    </div>
  </footer>

  <!-- =====================
       ADMIN MODAL (CRUD)
       ===================== -->
  <dialog id="adminModal" aria-labelledby="adminTitle">
    <div class="admin-header">
      <div class="admin-title"><span>⚙️</span><span id="adminTitle">Admin Panel</span></div>
      <div class="toolbar">
        <button class="btn" id="exportBtn">⬇️ Export JSON</button>
        <label class="btn" for="importFile">⬆️ Import JSON</label>
        <input id="importFile" type="file" accept="application/json" class="visually-hidden" />
        <button class="btn" id="closeAdmin">✖️ Close</button>
      </div>
    </div>
    <div class="admin-body">
      <aside class="admin-nav" aria-label="Admin sections">
        <button data-tab="profile" class="active">Profile</button>
        <button data-tab="about">About</button>
        <button data-tab="skills">Skills</button>
        <button data-tab="experience">Experience</button>
        <button data-tab="projects">Projects</button>
        <button data-tab="certs">Certifications</button>
        <button data-tab="contact">Contact</button>
        <hr style="border-color:color-mix(in oklab, var(--muted) 18%, transparent)">
        <button data-tab="settings">Settings</button>
      </aside>
      <section class="admin-content">
        <!-- PROFILE -->
        <div class="tab" id="tab-profile">
          <div class="row">
            <div class="field"><label>ชื่อ (name)</label><input id="f_name" placeholder="ชื่อ"></div>
            <div class="field"><label>ตำแหน่ง (role)</label><input id="f_role" placeholder="ตำแหน่ง"></div>
          </div>
          <div class="field"><label>สรุป (summary)</label><textarea id="f_summary" placeholder="สรุปสั้น ๆ"></textarea></div>
          <div class="row">
            <div class="field"><label>รูปโปรไฟล์ (avatar_url)</label><input id="f_avatar" placeholder="https://..."></div>
            <div class="field"><label>Badge (ข้อความบนชิป)</label><input id="f_badge" placeholder="CCNA • OSPF • ..."></div>
          </div>
          <div class="field"><label>Tags (คั่นด้วย ,)</label><input id="f_tags" placeholder="OSPF,VLAN,VPN"></div>
          <div class="toolbar">
            <button class="btn primary" id="saveProfile">บันทึก</button>
          </div>
        </div>

        <!-- ABOUT -->
        <div class="tab" id="tab-about" hidden>
          <div class="field"><label>About / เกี่ยวกับ</label><textarea id="f_about" placeholder="อธิบายตัวเอง"></textarea></div>
          <button class="btn primary" id="saveAbout">บันทึก</button>
        </div>

        <!-- SKILLS -->
        <div class="tab" id="tab-skills" hidden>
          <div class="toolbar"><button class="btn primary" id="addSkill">+ Add Skill Group</button></div>
          <table class="table" id="skillsTable"></table>
        </div>

        <!-- EXPERIENCE -->
        <div class="tab" id="tab-experience" hidden>
          <div class="toolbar"><button class="btn primary" id="addExp">+ Add Experience</button></div>
          <table class="table" id="expTable"></table>
        </div>

        <!-- PROJECTS -->
        <div class="tab" id="tab-projects" hidden>
          <div class="toolbar"><button class="btn primary" id="addProj">+ Add Project</button></div>
          <table class="table" id="projTable"></table>
        </div>

        <!-- CERTS -->
        <div class="tab" id="tab-certs" hidden>
          <div class="toolbar"><button class="btn primary" id="addCert">+ Add Cert</button></div>
          <table class="table" id="certTable"></table>
        </div>

        <!-- CONTACT -->
        <div class="tab" id="tab-contact" hidden>
          <div class="row">
            <div class="field"><label>Email</label><input id="c_email" placeholder="you@example.com"></div>
            <div class="field"><label>Phone</label><input id="c_phone" placeholder=""></div>
          </div>
          <div class="row">
            <div class="field"><label>Location</label><input id="c_location" placeholder="Bangkok, TH"></div>
            <div class="field"><label>Website</label><input id="c_website" placeholder="https://..."></div>
          </div>
          <div class="row">
            <div class="field"><label>LinkedIn</label><input id="c_linkedin" placeholder="https://linkedin.com/in/... "></div>
            <div class="field"><label>GitHub</label><input id="c_github" placeholder="https://github.com/... "></div>
          </div>
          <button class="btn primary" id="saveContact">บันทึก</button>
        </div>

        <!-- SETTINGS -->
        <div class="tab" id="tab-settings" hidden>
          <div class="field"><label>Admin PIN (อย่างง่ายสำหรับเปิดหลังบ้าน)</label><input id="pinInput" type="password" placeholder="ตั้งค่า PIN"></div>
          <div class="toolbar">
            <button class="btn" id="setPin">ตั้ง PIN</button>
            <button class="btn danger" id="resetAll" title="ล้างข้อมูลทั้งหมด">ล้างข้อมูลทั้งหมด</button>
          </div>
          <p class="muted">หมายเหตุ: ระบบนี้ทำงานฝั่งผู้ใช้ (client-side) เหมาะกับโฮสต์แบบ static เช่น GitHub Pages. ถ้าต้องการล็อกอินจริง/เขียนไฟล์อัตโนมัติ ให้ต่อยอดด้วย GitHub API/Serverless.</p>
        </div>
      </section>
    </div>
  </dialog>

  <script>
    /* ========= Utilities ========= */
    const $ = (sel, ctx=document) => ctx.querySelector(sel);
    const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));
    const saveFile = (name, data) => {
      const blob = new Blob([data], {type:'application/json'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob); a.download = name; a.click(); URL.revokeObjectURL(a.href);
    };

    /* ========= I18N (สั้น ๆ) ========= */
    const I18N = {
      th: {sections:{about:'About / เกี่ยวกับ',skills:'Skills / ทักษะ',experience:'Experience / ประสบการณ์',projects:'Projects / โปรเจกต์',certs:'Certifications',contact:'Contact / ติดต่อ'}},
      en: {sections:{about:'About',skills:'Skills',experience:'Experience',projects:'Projects',certs:'Certifications',contact:'Contact'}}
    };
    function applyI18n(lang){
      const d = I18N[lang]||I18N.th;
      $(`#about .section-title h2`).textContent = d.sections.about;
      $(`#skills .section-title h2`).textContent = d.sections.skills;
      $(`#experience .section-title h2`).textContent = d.sections.experience;
      $(`#projects .section-title h2`).textContent = d.sections.projects;
      $(`#certs .section-title h2`).textContent = d.sections.certs;
      $(`#contact .section-title h2`).textContent = d.sections.contact;
    }

    /* ========= Theme ========= */
    function setTheme(mode){ if(mode==='dark'){ document.body.classList.remove('light'); localStorage.setItem('theme','dark'); } else { document.body.classList.add('light'); localStorage.setItem('theme','light'); } }
    $('#themeToggle').addEventListener('click',()=>{ const isLight = document.body.classList.contains('light'); setTheme(isLight? 'dark':'light'); });

    /* ========= Language ========= */
    const langLabel = $('#langLabel');
    $('#langToggle').addEventListener('click',()=>{ const next = (localStorage.getItem('lang')||'th')==='th' ? 'en':'th'; localStorage.setItem('lang', next); langLabel.textContent = next.toUpperCase(); applyI18n(next); });

    /* ========= Print ========= */
    $('#printBtn').addEventListener('click', e=>{ e.preventDefault(); window.print(); });
    document.addEventListener('keydown', e=>{ if(e.key.toLowerCase()==='p'){ e.preventDefault(); window.print(); } });

    /* ========= Data Model ========= */
    const STORAGE_KEY = 'portfolio.siteData.v1';
    const DEFAULT_DATA = {
      profile: { name: 'ชาคร หวังปอ', role: 'Network Engineer', summary: 'CCNA‑certified network engineer focused on stability, security, and maintainable designs with ~2 years of experience.', avatar_url: '', badge: 'CCNA • OSPF • VLAN • VPN • WLC • Firewall', tags: ['OSPF','VLAN','VPN','WLC','Monitoring','Firewall'] },
      about: 'Designing secure, resilient networks with a strong focus on documentation and monitoring.',
      skills: [
        { title: 'Routing & Switching', items: ['OSPF', 'VLAN', 'STP', 'EtherChannel'] },
        { title: 'Security', items: ['Firewall', 'Site‑to‑Site VPN', 'ACLs'] },
        { title: 'Wireless', items: ['WLC', 'WPA2‑Enterprise', 'RF Survey (เบื้องต้น)'] }
      ],
      experience: [
        { company: 'ABC Corp', role: 'Network Engineer', period: '2023 – ปัจจุบัน', summary: 'ออกแบบ/ดูแลเครือข่ายสาขา ~20 จุด, ทำเอกสารและมอนิเตอร์', stack: ['Cisco','MikroTik','Zabbix'] }
      ],
      projects: [
        { name: 'Branch WAN Hardening', description: 'ยกเครื่อง ACL, VPN, และ logging สำหรับสาขา', tags: ['VPN','ACL','Logging'], link: '' }
      ],
      certifications: [
        { name: 'CCNA', org: 'Cisco', year: '2024' }
      ],
      contact: { email:'you@example.com', phone:'', location:'Bangkok, TH', website:'', linkedin:'', github:'' }
    };

    function loadData(){
      try{ return JSON.parse(localStorage.getItem(STORAGE_KEY)) || DEFAULT_DATA; }catch(e){ return DEFAULT_DATA }
    }
    function saveData(data){ localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); }

    /* ========= Hydrate ========= */
    function chip(text){ const el=document.createElement('span'); el.className='chip'; el.textContent=text; return el; }
    function hydrate(data){
      const p = data.profile || {};
      $('#name').textContent = p.name || 'MoonLPO';
      $('#footName').textContent = p.name || 'MoonLPO';
      $('#role').textContent = p.role || 'Network Engineer';
      $('#summary').textContent = p.summary || $('#summary').textContent;
      $('#badge').textContent = p.badge || 'CCNA • OSPF • VLAN • VPN • WLC • Firewall';
      if(p.avatar_url) $('#avatar').src = p.avatar_url;
      const tags = p.tags || []; const wrap = $('#tags'); wrap.innerHTML=''; tags.forEach(t=>wrap.appendChild(chip(t)));

      // About
      if(data.about) $('#aboutText').textContent = data.about;

      // Skills
      const sgrid = $('#skillsGrid'); sgrid.innerHTML='';
      (data.skills||[]).forEach(s=>{ const c=document.createElement('div'); c.className='card'; c.innerHTML = `<h3>${s.title||'Skill'}</h3><p>${(s.items||[]).join(' • ')}</p>`; sgrid.appendChild(c); });

      // Experience
      const egrid = $('#expGrid'); egrid.innerHTML='';
      (data.experience||[]).forEach(e=>{ const c=document.createElement('div'); c.className='card'; c.innerHTML = `<h3>${e.company||''} · ${e.role||''}</h3><p>${e.period||''}</p><p>${e.summary||''}</p><div class="meta">${(e.stack||[]).map(x=>`<span>${x}</span>`).join('')}</div>`; egrid.appendChild(c); });

      // Projects
      const pgrid = $('#projGrid'); pgrid.innerHTML='';
      (data.projects||[]).forEach(pj=>{ const c=document.createElement('div'); c.className='card'; c.innerHTML = `<h3>${pj.name||''}</h3><p>${pj.description||''}</p><div class="meta">${(pj.tags||[]).map(x=>`<span>${x}</span>`).join('')}</div>${pj.link? `<p><a href="${pj.link}" target="_blank" rel="noopener">${pj.link}</a></p>`:''}`; pgrid.appendChild(c); });

      // Certs
      const cgrid = $('#certGrid'); cgrid.innerHTML='';
      (data.certifications||[]).forEach(ct=>{ const c=document.createElement('div'); c.className='card'; c.innerHTML = `<h3>${ct.name||''}</h3><p>${ct.org||''} • ${ct.year||''}</p>`; cgrid.appendChild(c); });

      // Contact
      const contact = data.contact || {};
      $('#contactName').textContent = p.name || 'MoonLPO';
      $('#contactRole').textContent = p.role || 'Network Engineer';
      const meta = $('#contactMeta'); meta.innerHTML='';
      const rows = [
        contact.email? {k:'Email', v: `<a href="mailto:${contact.email}">${contact.email}</a>`}: null,
        contact.phone? {k:'Phone', v: contact.phone}: null,
        contact.location? {k:'Location', v: contact.location}: null,
        contact.website? {k:'Website', v: `<a href="${contact.website}" target="_blank" rel="noopener">${contact.website}</a>`}: null,
        contact.linkedin? {k:'LinkedIn', v: `<a href="${contact.linkedin}" target="_blank" rel="noopener">${contact.linkedin}</a>`}: null,
        contact.github? {k:'GitHub', v: `<a href="${contact.github}" target="_blank" rel="noopener">${contact.github}</a>`}: null,
      ].filter(Boolean);
      rows.forEach(r=>{ const span = document.createElement('span'); span.innerHTML = `<strong>${r.k}:</strong> ${r.v}`; meta.appendChild(span); });
    }

    /* ========= Admin Auth (PIN แบบง่าย) ========= */
    const PIN_KEY = 'portfolio.admin.pin';
    function getPin(){ return localStorage.getItem(PIN_KEY) || 'admin1234'; }
    function setPin(v){ localStorage.setItem(PIN_KEY, v); alert('ตั้ง PIN ใหม่แล้ว'); }

    /* ========= Admin UI wiring ========= */
    const adminBtn = $('#adminBtn');
    const adminModal = $('#adminModal');
    const closeAdmin = $('#closeAdmin');

    adminBtn.addEventListener('click', ()=>{
      const input = prompt('ใส่ PIN เพื่อเข้า Admin:');
      if(input === getPin()){
        adminModal.showModal();
        renderAdmin(loadData());
      }else if(input!==null){
        alert('PIN ไม่ถูกต้อง');
      }
    });
    closeAdmin.addEventListener('click', ()=> adminModal.close());

    // Nav tabs
    $$('.admin-nav button').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        $$('.admin-nav button').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        $$('.tab').forEach(t=>t.hidden=true);
        $(`#tab-${btn.dataset.tab}`).hidden=false;
      })
    })

    function renderAdmin(data){
      // Fill profile
      $('#f_name').value = data.profile?.name || '';
      $('#f_role').value = data.profile?.role || '';
      $('#f_summary').value = data.profile?.summary || '';
      $('#f_avatar').value = data.profile?.avatar_url || '';
      $('#f_badge').value = data.profile?.badge || '';
      $('#f_tags').value = (data.profile?.tags||[]).join(',');
      // About
      $('#f_about').value = data.about || '';
      // Contact
      $('#c_email').value = data.contact?.email || '';
      $('#c_phone').value = data.contact?.phone || '';
      $('#c_location').value = data.contact?.location || '';
      $('#c_website').value = data.contact?.website || '';
      $('#c_linkedin').value = data.contact?.linkedin || '';
      $('#c_github').value = data.contact?.github || '';
      // PIN
      $('#pinInput').value = getPin();

      // Skills table
      const st = $('#skillsTable'); st.innerHTML = '';
      const sHead = `<tr><th style="width:28%">หัวข้อ</th><th>รายการ (คั่นด้วย ,)</th><th style="width:120px">Actions</th></tr>`; st.insertAdjacentHTML('beforeend', sHead);
      (data.skills||[]).forEach((s,i)=>{
        st.insertAdjacentHTML('beforeend',`
          <tr>
            <td><input data-s="title" data-i="${i}" value="${s.title||''}"></td>
            <td><input data-s="items" data-i="${i}" value="${(s.items||[]).join(',')}"></td>
            <td>
              <button class="btn" data-action="up" data-i="${i}" title="ขึ้น">↑</button>
              <button class="btn" data-action="down" data-i="${i}" title="ลง">↓</button>
              <button class="btn" data-action="del" data-i="${i}" title="ลบ">🗑️</button>
            </td>
          </tr>`)
      });

      // Experience table
      const et = $('#expTable'); et.innerHTML = '';
      et.insertAdjacentHTML('beforeend', `<tr><th>บริษัท</th><th>ตำแหน่ง</th><th>ช่วงเวลา</th><th>สรุป</th><th>Stack (คั่นด้วย ,)</th><th style="width:120px">Actions</th></tr>`);
      (data.experience||[]).forEach((e,i)=>{
        et.insertAdjacentHTML('beforeend',`
          <tr>
            <td><input data-k="company" data-i="${i}" value="${e.company||''}"></td>
            <td><input data-k="role" data-i="${i}" value="${e.role||''}"></td>
            <td><input data-k="period" data-i="${i}" value="${e.period||''}"></td>
            <td><input data-k="summary" data-i="${i}" value="${e.summary||''}"></td>
            <td><input data-k="stack" data-i="${i}" value="${(e.stack||[]).join(',')}"></td>
            <td>
              <button class="btn" data-action="up-exp" data-i="${i}">↑</button>
              <button class="btn" data-action="down-exp" data-i="${i}">↓</button>
              <button class="btn" data-action="del-exp" data-i="${i}">🗑️</button>
            </td>
          </tr>`)
      });

      // Projects
      const pt = $('#projTable'); pt.innerHTML='';
      pt.insertAdjacentHTML('beforeend', `<tr><th>ชื่อโปรเจกต์</th><th>คำอธิบาย</th><th>Tags</th><th>ลิงก์</th><th style="width:120px">Actions</th></tr>`);
      (data.projects||[]).forEach((p,i)=>{
        pt.insertAdjacentHTML('beforeend',`
          <tr>
            <td><input data-p="name" data-i="${i}" value="${p.name||''}"></td>
            <td><input data-p="description" data-i="${i}" value="${p.description||''}"></td>
            <td><input data-p="tags" data-i="${i}" value="${(p.tags||[]).join(',')}"></td>
            <td><input data-p="link" data-i="${i}" value="${p.link||''}"></td>
            <td>
              <button class="btn" data-action="up-proj" data-i="${i}">↑</button>
              <button class="btn" data-action="down-proj" data-i="${i}">↓</button>
              <button class="btn" data-action="del-proj" data-i="${i}">🗑️</button>
            </td>
          </tr>`)
      });

      // Certs
      const ct = $('#certTable'); ct.innerHTML='';
      ct.insertAdjacentHTML('beforeend', `<tr><th>ชื่อใบรับรอง</th><th>ผู้ออก</th><th>ปี</th><th style="width:120px">Actions</th></tr>`);
      (data.certifications||[]).forEach((c,i)=>{
        ct.insertAdjacentHTML('beforeend',`
          <tr>
            <td><input data-c="name" data-i="${i}" value="${c.name||''}"></td>
            <td><input data-c="org" data-i="${i}" value="${c.org||''}"></td>
            <td><input data-c="year" data-i="${i}" value="${c.year||''}"></td>
            <td>
              <button class="btn" data-action="up-cert" data-i="${i}">↑</button>
              <button class="btn" data-action="down-cert" data-i="${i}">↓</button>
              <button class="btn" data-action="del-cert" data-i="${i}">🗑️</button>
            </td>
          </tr>`)
      });
    }

    // Save buttons
    $('#saveProfile').addEventListener('click', ()=>{
      const d = loadData();
      d.profile = {
        name: $('#f_name').value.trim(),
        role: $('#f_role').value.trim(),
        summary: $('#f_summary').value.trim(),
        avatar_url: $('#f_avatar').value.trim(),
        badge: $('#f_badge').value.trim(),
        tags: $('#f_tags').value.split(',').map(x=>x.trim()).filter(Boolean)
      };
      saveData(d); hydrate(d); alert('บันทึกโปรไฟล์แล้ว');
    });

    $('#saveAbout').addEventListener('click', ()=>{ const d = loadData(); d.about = $('#f_about').value; saveData(d); hydrate(d); alert('บันทึก About แล้ว'); });
    $('#saveContact').addEventListener('click', ()=>{
      const d = loadData(); d.contact = { email: $('#c_email').value, phone: $('#c_phone').value, location: $('#c_location').value, website: $('#c_website').value, linkedin: $('#c_linkedin').value, github: $('#c_github').value }; saveData(d); hydrate(d); alert('บันทึก Contact แล้ว');
    });

    // Add rows
    $('#addSkill').addEventListener('click', ()=>{ const d = loadData(); d.skills = d.skills||[]; d.skills.push({title:'', items:[]}); saveData(d); renderAdmin(d); });
    $('#addExp').addEventListener('click', ()=>{ const d = loadData(); d.experience = d.experience||[]; d.experience.push({company:'', role:'', period:'', summary:'', stack:[]}); saveData(d); renderAdmin(d); });
    $('#addProj').addEventListener('click', ()=>{ const d = loadData(); d.projects = d.projects||[]; d.projects.push({name:'', description:'', tags:[], link:''}); saveData(d); renderAdmin(d); });
    $('#addCert').addEventListener('click', ()=>{ const d = loadData(); d.certifications = d.certifications||[]; d.certifications.push({name:'', org:'', year:''}); saveData(d); renderAdmin(d); });

    // Tables delegate (edit/move/delete)
    document.addEventListener('input', (e)=>{
      const t=e.target; const d = loadData();
      if(t.dataset.s){ const i=+t.dataset.i; d.skills[i] = d.skills[i]||{}; if(t.dataset.s==='title') d.skills[i].title = t.value; if(t.dataset.s==='items') d.skills[i].items = t.value.split(',').map(x=>x.trim()).filter(Boolean); saveData(d); }
      if(t.dataset.k){ const i=+t.dataset.i; d.experience[i] = d.experience[i]||{}; d.experience[i][t.dataset.k] = t.value; if(t.dataset.k==='stack') d.experience[i].stack = t.value.split(',').map(x=>x.trim()).filter(Boolean); saveData(d); }
      if(t.dataset.p){ const i=+t.dataset.i; d.projects[i] = d.projects[i]||{}; if(t.dataset.p==='tags') d.projects[i].tags = t.value.split(',').map(x=>x.trim()).filter(Boolean); else d.projects[i][t.dataset.p]=t.value; saveData(d); }
      if(t.dataset.c){ const i=+t.dataset.i; d.certifications[i] = d.certifications[i]||{}; d.certifications[i][t.dataset.c] = t.value; saveData(d); }
      hydrate(loadData());
    });

    document.addEventListener('click', (e)=>{
      const btn = e.target.closest('button'); if(!btn) return; const act = btn.dataset.action; if(!act) return; const i = +btn.dataset.i; const d = loadData();
      const move = (arr, from, to)=>{ if(to<0||to>=arr.length) return; const x=arr.splice(from,1)[0]; arr.splice(to,0,x); };
      if(act==='del'){ d.skills.splice(i,1); saveData(d); renderAdmin(d); hydrate(d); }
      if(act==='up'){ move(d.skills,i,i-1); saveData(d); renderAdmin(d); hydrate(d); }
      if(act==='down'){ move(d.skills,i,i+1); saveData(d); renderAdmin(d); hydrate(d); }

      if(act==='del-exp'){ d.experience.splice(i,1); saveData(d); renderAdmin(d); hydrate(d); }
      if(act==='up-exp'){ move(d.experience,i,i-1); saveData(d); renderAdmin(d); hydrate(d); }
      if(act==='down-exp'){ move(d.experience,i,i+1); saveData(d); renderAdmin(d); hydrate(d); }

      if(act==='del-proj'){ d.projects.splice(i,1); saveData(d); renderAdmin(d); hydrate(d); }
      if(act==='up-proj'){ move(d.projects,i,i-1); saveData(d); renderAdmin(d); hydrate(d); }
      if(act==='down-proj'){ move(d.projects,i,i+1); saveData(d); renderAdmin(d); hydrate(d); }

      if(act==='del-cert'){ d.certifications.splice(i,1); saveData(d); renderAdmin(d); hydrate(d); }
      if(act==='up-cert'){ move(d.certifications,i,i-1); saveData(d); renderAdmin(d); hydrate(d); }
      if(act==='down-cert'){ move(d.certifications,i,i+1); saveData(d); renderAdmin(d); hydrate(d); }
    });

    // Settings
    $('#setPin').addEventListener('click', ()=>{ const v = $('#pinInput').value.trim(); if(v.length<4){ alert('ตั้ง PIN อย่างน้อย 4 ตัว'); return; } setPin(v); });
    $('#resetAll').addEventListener('click', ()=>{ if(confirm('ล้างข้อมูลทั้งหมด?')){ localStorage.removeItem(STORAGE_KEY); hydrate(DEFAULT_DATA); renderAdmin(DEFAULT_DATA); saveData(DEFAULT_DATA); }});

    // Export / Import
    $('#exportBtn').addEventListener('click', ()=>{ saveFile('site.json', JSON.stringify(loadData(), null, 2)); });
    $('#importFile').addEventListener('change', async (e)=>{
      const f = e.target.files[0]; if(!f) return; const txt = await f.text(); try{ const obj = JSON.parse(txt); saveData(obj); hydrate(obj); renderAdmin(obj); alert('นำเข้าแล้ว'); }catch(err){ alert('ไฟล์ไม่ถูกต้อง'); }
    });

    // Init
    (function(){
      const saved = localStorage.getItem('theme'); setTheme(saved||'light');
      const lang = localStorage.getItem('lang')||'th'; langLabel.textContent = lang.toUpperCase(); applyI18n(lang);
      const data = loadData(); hydrate(data);
      $('#year').textContent = new Date().getFullYear();
      // smooth anchors
      document.querySelectorAll('a[href^="#"]').forEach(a=>{
        a.addEventListener('click', e=>{ const id=a.getAttribute('href').slice(1); const el=document.getElementById(id); if(el){ e.preventDefault(); el.scrollIntoView({behavior:'smooth', block:'start'});} });
      });
    })();
  </script>
</body>
</html>
